{"remainingRequest":"/Users/anastasiaspileva/WebHW/lesson11/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/anastasiaspileva/WebHW/lesson11/frontend/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/anastasiaspileva/WebHW/lesson11/frontend/src/App.vue","mtime":1640356962783},{"path":"/Users/anastasiaspileva/WebHW/lesson11/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1640344604407},{"path":"/Users/anastasiaspileva/WebHW/lesson11/frontend/node_modules/babel-loader/lib/index.js","mtime":1640344604613},{"path":"/Users/anastasiaspileva/WebHW/lesson11/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1640344604407},{"path":"/Users/anastasiaspileva/WebHW/lesson11/frontend/node_modules/vue-loader/lib/index.js","mtime":1640344604687}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIZWFkZXIgZnJvbSAiLi9jb21wb25lbnRzL0hlYWRlciI7CmltcG9ydCBNaWRkbGUgZnJvbSAiLi9jb21wb25lbnRzL01pZGRsZSI7CmltcG9ydCBGb290ZXIgZnJvbSAiLi9jb21wb25lbnRzL0Zvb3RlciI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyIKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQXBwJywKICBjb21wb25lbnRzOiB7CiAgICBGb290ZXIsCiAgICBNaWRkbGUsCiAgICBIZWFkZXIKICB9LAogIGRhdGE6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXI6IG51bGwsCiAgICAgIHVzZXJzOiBbXSwKICAgICAgcG9zdHM6IFtdCiAgICB9CiAgfSwKICBiZWZvcmVNb3VudCgpIHsKICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiand0IikgJiYgIXRoaXMudXNlcikgewogICAgICB0aGlzLiRyb290LiRlbWl0KCJvbkp3dCIsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJqd3QiKSk7CiAgICB9CgogICAgYXhpb3MuZ2V0KCIvYXBpLzEvcG9zdHMiKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgdGhpcy5wb3N0cyA9IHJlc3BvbnNlLmRhdGE7CiAgICB9KTsKCiAgICBheGlvcy5nZXQoIi9hcGkvMS91c2VycyIpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICB0aGlzLnVzZXJzID0gcmVzcG9uc2UuZGF0YTsKICAgIH0pOwogIH0sCiAgYmVmb3JlQ3JlYXRlOiBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLiRyb290LiRvbigib25FbnRlciIsIChsb2dpbiwgcGFzc3dvcmQpID0+IHsKICAgICAgaWYgKHBhc3N3b3JkID09PSAiIikgewogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uRW50ZXJWYWxpZGF0aW9uRXJyb3IiLCAiUGFzc3dvcmQgaXMgcmVxdWlyZWQiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGF4aW9zLnBvc3QoIi9hcGkvMS9qd3QiLCB7CiAgICAgICAgbG9naW4sIHBhc3N3b3JkCiAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJqd3QiLCByZXNwb25zZS5kYXRhKTsKICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJvbkp3dCIsIHJlc3BvbnNlLmRhdGEpOwogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25FbnRlclZhbGlkYXRpb25FcnJvciIsIGVycm9yLnJlc3BvbnNlLmRhdGEpOwogICAgICB9KTsKICAgIH0pOwoKICAgIHRoaXMuJHJvb3QuJG9uKCJvblJlZ2lzdGVyIiwgKGxvZ2luLCBuYW1lLCBwYXNzd29yZCkgPT4gewogICAgICBsb2dpbiA9IGxvZ2luLnRyaW0oKQogICAgICBuYW1lID0gbmFtZS50cmltKCkKICAgICAgaWYgKHBhc3N3b3JkID09PSAiIikgewogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uUmVnaXN0ZXJWYWxpZGF0aW9uRXJyb3IiLCAiUGFzc3dvcmQgaXMgcmVxdWlyZWQiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmIChsb2dpbi5sZW5ndGggPCAzIHx8IGxvZ2luLmxlbmd0aCA+IDE2KSB7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25SZWdpc3RlclZhbGlkYXRpb25FcnJvciIsICJMb2dpbiBzaG91bGQgY29udGFpbiBmcm9tIDMgdG8gMTYgY2hhcmFjdGVycyIpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIWxvZ2luLm1hdGNoKC9eW2Etel0rJC8pKSB7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25SZWdpc3RlclZhbGlkYXRpb25FcnJvciIsICJMb2dpbiBzaG91bGQgY29udGFpbiBvbmx5IGxvd2VyY2FzZSBsYXRpbiBsZXR0ZXJzIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChuYW1lLmxlbmd0aCA9PT0gMCB8fCBuYW1lLmxlbmd0aCA+IDMyKSB7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25SZWdpc3RlclZhbGlkYXRpb25FcnJvciIsICJOYW1lIHNob3VsZCBjb250YWluIGZyb20gMSB0byAzMiBjaGFyYWN0ZXJzIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBheGlvcy5wb3N0KCIvYXBpLzEvdXNlcnMiLCB7CiAgICAgICAgbG9naW4sIG5hbWUsIHBhc3N3b3JkCiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJvblJlZ2lzdGVyVmFsaWRhdGlvbkVycm9yIiwgZXJyb3IucmVzcG9uc2UuZGF0YSk7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzCiAgICAgIH0pLnRoZW4oXyA9PiB7CiAgICAgICAgYXhpb3MuZ2V0KCIvYXBpLzEvdXNlcnMiKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgIHRoaXMudXNlcnMgPSByZXNwb25zZS5kYXRhOwogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uRW50ZXIiLCBsb2dpbiwgcGFzc3dvcmQpOwogICAgICB9KQogICAgfSk7CgogICAgdGhpcy4kcm9vdC4kb24oIm9uSnd0IiwgKGp3dCkgPT4gewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgiand0Iiwgand0KTsKCiAgICAgIGF4aW9zLmdldCgiL2FwaS8xL3VzZXJzL2F1dGgiLCB7CiAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICBqd3QKICAgICAgICB9CiAgICAgIH0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIHRoaXMudXNlciA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25DaGFuZ2VQYWdlIiwgIkluZGV4Iik7CiAgICAgIH0pLmNhdGNoKCgpID0+IHRoaXMuJHJvb3QuJGVtaXQoIm9uTG9nb3V0IikpCiAgICB9KTsKCiAgICB0aGlzLiRyb290LiRvbigib25Mb2dvdXQiLCAoKSA9PiB7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJqd3QiKTsKICAgICAgdGhpcy51c2VyID0gbnVsbDsKICAgIH0pOwoKICB9Cn0K"},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;AASA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <Header :user=\"user\"/>\n    <Middle :posts=\"posts\" :users=\"users\"/>\n    <Footer/>\n  </div>\n</template>\n\n<script>\nimport Header from \"./components/Header\";\nimport Middle from \"./components/Middle\";\nimport Footer from \"./components/Footer\";\nimport axios from \"axios\"\n\nexport default {\n  name: 'App',\n  components: {\n    Footer,\n    Middle,\n    Header\n  },\n  data: function () {\n    return {\n      user: null,\n      users: [],\n      posts: []\n    }\n  },\n  beforeMount() {\n    if (localStorage.getItem(\"jwt\") && !this.user) {\n      this.$root.$emit(\"onJwt\", localStorage.getItem(\"jwt\"));\n    }\n\n    axios.get(\"/api/1/posts\").then(response => {\n      this.posts = response.data;\n    });\n\n    axios.get(\"/api/1/users\").then(response => {\n      this.users = response.data;\n    });\n  },\n  beforeCreate: function () {\n    this.$root.$on(\"onEnter\", (login, password) => {\n      if (password === \"\") {\n        this.$root.$emit(\"onEnterValidationError\", \"Password is required\");\n        return;\n      }\n\n      axios.post(\"/api/1/jwt\", {\n        login, password\n      }).then(response => {\n        localStorage.setItem(\"jwt\", response.data);\n        this.$root.$emit(\"onJwt\", response.data);\n      }).catch(error => {\n        this.$root.$emit(\"onEnterValidationError\", error.response.data);\n      });\n    });\n\n    this.$root.$on(\"onRegister\", (login, name, password) => {\n      login = login.trim()\n      name = name.trim()\n      if (password === \"\") {\n        this.$root.$emit(\"onRegisterValidationError\", \"Password is required\");\n        return;\n      }\n\n      if (login.length < 3 || login.length > 16) {\n        this.$root.$emit(\"onRegisterValidationError\", \"Login should contain from 3 to 16 characters\");\n        return;\n      }\n      if (!login.match(/^[a-z]+$/)) {\n        this.$root.$emit(\"onRegisterValidationError\", \"Login should contain only lowercase latin letters\");\n        return;\n      }\n      if (name.length === 0 || name.length > 32) {\n        this.$root.$emit(\"onRegisterValidationError\", \"Name should contain from 1 to 32 characters\");\n        return;\n      }\n\n      axios.post(\"/api/1/users\", {\n        login, name, password\n      }).catch(error => {\n        this.$root.$emit(\"onRegisterValidationError\", error.response.data);\n        // eslint-disable-next-line no-unused-vars\n      }).then(_ => {\n        axios.get(\"/api/1/users\").then(response => {\n          this.users = response.data;\n        });\n        this.$root.$emit(\"onEnter\", login, password);\n      })\n    });\n\n    this.$root.$on(\"onJwt\", (jwt) => {\n      localStorage.setItem(\"jwt\", jwt);\n\n      axios.get(\"/api/1/users/auth\", {\n        params: {\n          jwt\n        }\n      }).then(response => {\n        this.user = response.data;\n        this.$root.$emit(\"onChangePage\", \"Index\");\n      }).catch(() => this.$root.$emit(\"onLogout\"))\n    });\n\n    this.$root.$on(\"onLogout\", () => {\n      localStorage.removeItem(\"jwt\");\n      this.user = null;\n    });\n\n  }\n}\n</script>\n\n<style>\n#app {\n\n}\n</style>\n"]}]}